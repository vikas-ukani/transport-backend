generator client {
  provider             = "prisma-client-py"
  recursive_type_depth = "5"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
//   // provider = "sqlite"
//   // url      = "file:./dev.db"
// }

model User {
  id              Int      @id @default(autoincrement())
  name            String
  email           String   @unique
  mobile          String   @unique
  type            String   @default("driver")
  password        String
  photo           String?
  referralCode    String?
  defaultLanguage String   @default("gu")
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  isVerified      Boolean  @default(false)
  posts           Post[]
}

model Post {
  id          Int       @id @default(autoincrement())
  title       String
  content     String?
  published   Boolean   @default(false)
  isActive    Boolean   @default(false)
  author      User?     @relation(fields: [authorId], references: [id])
  authorId    Int?
  images      Media[]   @relation("PostImages") // Multiple media files (usually images) related to a single post
  likeCount   Int       @default(0)
  publishedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Media {
  id         Int      @id @default(autoincrement())
  url        String
  type       String   // e.g., "image", "video", "audio", "document"
  mimeType   String?  // e.g., "image/jpeg", "video/mp4", etc.
  size       Int?     // Size in bytes
  uploadedAt DateTime @default(now())

  // Optional: Media can belong to a Post (as an image)
  post      Post?     @relation("PostImages", fields: [postId], references: [id])
  postId    Int?
}
